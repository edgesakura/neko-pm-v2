task_id: "task-20260206T112117-kitten1"
assigned_to: "kitten1"
timestamp: "2026-02-06T11:21:17"
priority: high
load_skills: []
description: |
  【Step 1】CloudWatch Logs確認 + Lambda関数名特定

  ## 目的
  LINE Bot経由でエラーが返る問題の根本原因を特定するため、Lambda実行ログを調査するにゃ。

  ## 実施内容

  ### 1. Lambda関数名の特定
  CDKスタックから Lambda関数の PhysicalResourceId を取得するにゃ。
  ```bash
  aws cloudformation describe-stack-resources \
    --stack-name IzakayaStack \
    --region ap-northeast-1 \
    --query "StackResources[?ResourceType=='AWS::Lambda::Function'].PhysicalResourceId"
  ```

  ### 2. CloudWatch Logs 確認
  Lambda関数名を特定したら、最新の実行ログを確認するにゃ。
  ```bash
  # Lambda関数名を <関数名> に置き換える
  aws logs filter-log-events \
    --log-group-name /aws/lambda/<関数名> \
    --start-time $(date -d '1 hour ago' +%s)000 \
    --region ap-northeast-1
  ```

  ### 3. エラーメッセージ・スタックトレースの収集
  - エラーメッセージを特定
  - スタックトレースを収集
  - タイムスタンプを記録
  - エラーの発生パターンを分析

  ## 期待する成果物
  - Lambda関数名
  - エラーメッセージ・スタックトレース
  - エラー発生パターンの分析結果
  - queue/reports/report-20260206T112117-kitten1.yaml に報告

context:
  references:
    - "output/izakaya-agent/cdk/"
  service_name: "izakaya-agent"
  project_dir: "output/izakaya-agent"
  region: "ap-northeast-1"
  stack_name: "IzakayaStack"

expected_outputs:
  - "Lambda関数名の特定"
  - "CloudWatch Logs のエラーメッセージ・スタックトレース"
  - "エラー発生パターンの分析結果"
  - "queue/reports/report-20260206T112117-kitten1.yaml"
