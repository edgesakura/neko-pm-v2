task_id: "task-20260130100603-kitten2"
assigned_to: "kitten2"
timestamp: "2026-01-30T10:06:03Z"
priority: high
description: |
  【chat-app フロントエンド改修】Phase 1 & 2

  スマホからボスねこと会話できるようにするため、フロントエンド機能を拡張するにゃ。

  ## Phase 1: 状態表示UI

  ### 1.1 システム状態表示セクション
  - 新しいセクション「システム状態」を追加
  - nawabari.md の内容をMarkdownレンダリングして表示
  - 子猫の状態を視覚的に表示：
    - 🔍 調査中 / ⚙️ 作業中 / ✅ 完了 / 😴 待機中
  - タスク一覧を表形式で表示
  - 最終更新時刻を表示

  ### 1.2 リアルタイム更新
  - WebSocketイベント `system-status` を受信
  - 受信した状態を画面に反映（スムーズなアニメーション）
  - 更新時に視覚的なフィードバック（点滅など）

  ### 1.3 レイアウト設計（スマホ対応）
  ```
  ┌─────────────────────┐
  │ [システム状態] ▼    │ ← アコーディオン（折り畳み可能）
  ├─────────────────────┤
  │ 作戦状況板          │
  │ ・作戦名            │
  │ ・子猫状態          │
  │ ・タスク一覧        │
  │ 最終更新: XX:XX     │
  ├─────────────────────┤
  │ [チャット] ▼        │
  ├─────────────────────┤
  │ メッセージ履歴      │
  │ ...                 │
  ├─────────────────────┤
  │ [入力欄]  [送信]    │
  └─────────────────────┘
  ```

  ## Phase 2: チャットUI改善

  ### 2.1 メッセージ送信UI改善
  - 送信ボタンのローディング状態表示
  - 送信中は入力欄を無効化
  - Enterキーで送信（Shift+Enterで改行）
  - 長文入力対応（textarea自動拡張）

  ### 2.2 メッセージ表示UI改善
  - ユーザーメッセージとボスねこの応答を視覚的に区別：
    - ユーザー: 右寄せ、青背景
    - ボスねこ: 左寄せ、灰背景
  - タイムスタンプ表示
  - Markdownレンダリング（コードブロック、リンクなど）
  - 自動スクロール（最新メッセージに追従）

  ### 2.3 レスポンシブデザイン（スマホ最適化）
  - ビューポート設定
  - タッチフレンドリーなボタンサイズ（最低44x44px）
  - フォントサイズ調整（16px以上、拡大禁止回避）
  - 縦スクロール最適化
  - ダークモード対応（オプション）

  ### 2.4 UX改善
  - 接続状態表示（🟢 接続中 / 🔴 切断）
  - エラーメッセージの表示（トースト通知）
  - 再接続機能（WebSocket切断時）
  - ローディングインジケーター（応答待ち時）

  ## 実装ガイドライン

  ### 必須ライブラリ（CDN推奨）
  ```html
  <!-- Markdown レンダリング -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- コードハイライト（オプション） -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  ```

  ### WebSocketイベント定義
  ```javascript
  // サーバー → クライアント
  ws.onmessage = (event) => {
    const data = JSON.parse(event.data);
    if (data.type === 'system-status') {
      // Phase 1.2: 状態表示を更新
      updateSystemStatus(data.data);
    }
    if (data.type === 'boss-response') {
      // Phase 2.2: ボスねこの応答を表示
      displayBossMessage(data.data.message);
    }
  };

  // クライアント → サーバー
  function sendToBoss(message) {
    ws.send(JSON.stringify({
      type: 'send-to-boss',
      message: message
    }));
  }
  ```

  ### CSS設計（モバイルファースト）
  ```css
  /* ベースはモバイル向け */
  @media (min-width: 768px) {
    /* デスクトップ向け調整 */
  }
  ```

  ## 重要な指示
  - 承認プロンプトが出たら、選択肢2（Yes, and don't ask again...）を選ぶにゃ
  - 既存のチャット機能を壊さないように注意
  - スマホで実際に動作確認すること
  - 完了したら send-keys で番猫（neko:workers.0）に通知するにゃ

context:
  command_id: "cmd-20260130-190000"
  service_name: "chat-app"
  project_root: "/home/edgesakura/git/neko-pm/output/chat-app"
  target_files:
    - "public/index.html"
    - "public/app.js"
    - "public/styles.css"
  references:
    - "/home/edgesakura/git/neko-pm/output/chat-app/public/"

expected_outputs:
  - "index.html 更新版（システム状態セクション追加）"
  - "app.js 更新版（WebSocketイベント処理、UI更新ロジック）"
  - "styles.css 更新版（レスポンシブデザイン、スマホ最適化）"
  - "動作確認スクリーンショット（スマホから）"
  - "レポートファイル: queue/reports/task-20260130100603-kitten2.yaml"
